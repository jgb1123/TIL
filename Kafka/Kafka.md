# Kafka

## Kafka?
* Kafka는 LinkedIn에서 개발되었고, Apache Software Foundation에 기증되어 Apache Software Foundation에서 관리되고 있다.
* Kafka는 대량의 데이터를 안정적으로 신속하게 처리할 수 있는 분산 스트리밍 플랫폼으로 사용된다.
* Kafka는 Topic이라는 개념을 사용하여 데이터를 구조화하고, Producer가 데이터를 특정 토픽에 전송하면 Consummer가 해당 토픽에서 데이터를 소비할 수 있다.
* 이러한 특징을 통해 데이터의 효율적인 분산 처리와 확장이 가능하다.

## Kafka 활용
### 데이터 스트리밍
* 대용량의 데이터를 실시간으로 처리하며, 이벤트 기반 아키텍처를 구현할 때 사용된다.

### 로그 수집
* 여러 소스에서 발생한 로그 데이터를 중앙집계하고 저장하기 위해 사용된다.

### 메시지 큐
* 분산 시스템 간의 통신을 위해 사용된다.
* Producer가 메시지를 생성하고 Consumer가 메시지를 소비하는 메시지 큐 시스템으로 활용된다.

### 이벤트 소싱
* 시스템 내에서 발생하는 모든 이벤트를 저장하고 분석하기 위해 사용된다.

## Cluster
* Kafka Cluster는 Apache Kafka의 분산형 메시징 시스템을 구성하는 서버 집합이다.
* Cluster는 여러 대의 서버로 구성되어 있고, 데이터를 안정적으로 저장하고 처리하며 확장성을 제공한다.
* Kafka는 고가용성을 위해 여러개의 Kafka 서버와 Zookeeper로 구성된 클러스토 구조로 사용된다.
  * 일반적으로 3개 이상의 Kafka서버로 구성하며, Broker에 저장된 메시지를 다른 Broker에게 공유하고 하나의 브로커에 문제가 생겼을 때 다른 브로커로 그 역할을 대체해서 시스템을 정상적으로 유지한다. 
* Zookeeper는 분산 애플리케이션의 데이터 관리 기능을 가지고 있고, 여러 개의 Broker들을 컨트롤해 주는 역할을 수행한다.

## Topic
* 토픽은 데이터를 구분하고 분류하기 위한 논리적인 단위이며, 데이터의 목적에 따라 선택된다.
* 각 토픽은 하나 이상의 파티션으로 나뉠 수 있다.
  * 각 파티션은 데이터를 분산하여 여러 브로커에게 저장하고 병렬로 처리하는데 사용된다.
* 토픽은 데이터를 생성하는 Producer와 데이터를 소비하는 Consumer 간 중간 매개체로 사용된다.
  * Producer는 데이터를 토픽으로 전송하고, Consumer는 해당 토픽에서 데이터를 소비한다.
* Kafka 클러스터의 관리자는 토픽을 생성하고 파티션 수, 복제 수 등을 설정할 수 있다.

### Partitions
* 토픽은 하나 이상의 파티션으로 나뉠 수 있다.
* 각 파티션은 일련의 순차적인 메시지를 포함하며, 이러한 파티션은 여러 브로커에 걸쳐 분산된다.
* 각 파티션은 병렬로 처리될 수 있기 때문에 데이터의 처리량과 성능을 향상시킨다.

### Replication
* 각 파티션은 여러 브로커에 복제될 수 있다.
* 고가용성을 제공하며 특정 브로커가 다운되더라도 해당 파티션의 데이터를 다른 복제본에서 읽을 수 있게 한다.

### Retention Policy
* 토픽은 보통 데이터 보존 정책을 가지고 있다.
* 데이터가 얼마나 오래 유지되어야 하는지를 나타내며, 시간 기반 또는 데이터 크기 기반으로 설정할 수 있다.

### Partition and Leader
* 각 파티션은 여러 브로커 중 하나에 Leader가 할당된다.
* 리더는 쓰기 작업을 담당하며, 다른 브로커들은 해당 리더로부터 데이터를 동기화하여 복제한다.

## Producer API
* Producer는 Kafka에서 데이터를 생성하고 Kafka 클러스터로 전송하는데 사용되는 인터페이스이다.
* Producer는 애플리케이션이 데이터를 생성하고 Kafka 토픽으로 전송하는 역할을 한다.
  * 데이터는 일반적으로 메시지, 이벤트, 레코드 등의 형태를 가지며 Kafka 클러스터에 전달된다.
* Producer는 생성한 데이터를 하나 이상의 토픽에 전송한다.
* 주로 비동기적으로 데이터를 전송하며, 데이터를 브로커에게 보내고 즉시 제어권을 반환하여 다른 작업을 수행할 수 있다.
  * 효율적인 전송을 위해 메시지를 일괄로 묶어서 전송할 수 있으며, 작은 메시지를 하나로 묶어 전송함으로써 네트워크 및 시스템 리소스를 효율적으로 사용할 수 있다.
* Producer는 메시지 전송 중 발생할 수 있는 에러를 처리할 수 있으며, 이를통해 안정적인 데이터 전송이 가능하고 메시지 손실을 최소화할 수 있다.
* Producer는 여러 브로커로 구성된 Kafka 클러스터에 대한 확장성을 지원하기 때문에 대량의 데이터를 처리하고 처리량을 증가시킬 수 있다.

## Consumer API 
* Kafka에서 데이터를 소비하고 Kafka 토픽으로부터 메시지를 읽어오는데 사용되는 인터페이스이다.
* Kafka 클러스터부터로 데이터를 가져와 애플리케이션에서 소비하거나 처리하는 역할을 한다.
* Consumer는 특정 토픽이나 토픽 그룹에서 메시지를 읽어오며 다수의 Consumer 인스턴스를 사용하여 병렬로 데이터를 처리할 수 있다.
* 데이터를 처리하는 방식은 주로 비동기적으로 이루어지며, 브로커로부터 메시지를 효과적으로 읽어오기 위해 최적화된 방식으로 동작한다.
  * 읽어온 메시지의 위치는 오프셋을 통해 추적되어 처리된 메시지를 관리할 수 있다.
* Consumer는 메시지 소비 중에 발생할 수 있는 에러를 처리할 수 있으며, 이를 통해 안정적인 데이터 소비 및 처리가 가능하다.
* Consumer는 여러 브로커로 구성된 Kafka 클러스터에 대한 확장성을 지원하기 때문에 대량의 데이터를 효과적으로 처리하고 실시간으로 데이터를 수신할 수 있다.