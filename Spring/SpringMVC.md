# Spring MVC

## Web Application
### Web Server
* 웹 서버는 HTTP기반으로 동작하는 서버이다.
* 정적 리소스를 제공하며, 기타 부가기능들을 제공한다. (HTML, CSS, JS, 이미지, 영상 등)
* ex) NGINX, APACHE

### Web Application Server(WAS)
* HTTP기반으로 동작한다
* web server 기능(정적 리소스 제공)을 포함하고 동적 리소스도 제공 가능하다.
* 프로그램 코드를 실행해서 애플리케이션 로직을 수행할 수 있다.
  * 동적 HTML, HTTP API 
  * 서블릿, JSP, 스프링MVC
* ex) 톰캣(Tomcat), Jetty, Undertow

### 웹 서버 vs 웹 애플리케이션 서버
* 웹 서버는 정적 리소스를 제공하고, WAS는 애플리케이션 로직까지 수행 가능하다.
* 자바의 경우, 서블릿 컨테이너 기능을 제공하면 WAS이다.(서블릿 없이 자바코드를 실행하는 서버 프레임워크도 있긴 함)
* WAS는 애플리케이션 코드를 실행하는데 더 특화되어있다고 생각하면 된다.

### 웹 시스템의 구성
* 웹 시스템은 WAS와 DB만으로 구성 가능하다
* 그러나 이렇게 구성하면 WAS가 너무 많은 역할을 담당하므로, 서버에 과부하가 생길 수 있다.
* 그래서 보통 WEB, WAS, DB로 구성한다. (정적 리소스는 웹 서버가 처리)
* 이렇게 구성하면, 정적 리소스가 많이 사용되면 웹 서버를 증설하면 되고 애플리케이션 리소스가 많이 사용되면 WAS를 증설하면 된다.
* 또한 정적 리소스만 제공하는 웹서버는 잘 죽지 않기 때문에 WAS, DB 장애 시 웹 서버로 오류화면을 제공해 줄 수도 있다.

## Servlet
* 서블릿은 TCP/IP 연결, HTTP 요청메시지 파싱(데이터 읽기), HTTP메시지 생성까지 다 자동으로 해준다.
* urlPatterns의 URL이 호출되면 서블릿 코드가 실행된다.
* HTTP 요청 정보를 편리하게 사용할 수 있는 HttpServletRequest가 있다.
* 반대로 HTTP 응답 정보를 편리하게 제공할 수 있는 HttpServletResponse가 있다.
* 서블릿으로 인해 개발자는 HTTP를 매우 편리하게 사용할 수 있다. (물론 HTTP도 기본적으로 알고 있어야 함)

### Servlet 동작
* WAS는 Request, Response 객체를 새로 만들어서 서블릿 객체를 호출한다.
* 개발자는 Request 객체에서 HTTP 요청 정보를 편리하게 꺼내서 사용한다.
* 개발자는 Response 객체에 HTTP 응답 정보를 편리하게 입력한다.
* WAS는 Response 객체에 담겨있는 내용으로 HTTP 응답 정보를 생성한다.

## Servlet Container
* 톰캣과 같이 서블릿을 지원하는 WAS를 서블릿 컨테이너라고 한다.
* 서블릿 컨테이너는 서블릿 객체를 생성, 초기화, 호출, 종료하는 생명주기를 관리한다.
* 서블릿 객체는 싱글톤으로 관리한다.
  * 최초 로딩 시점에 서블릿 객체를 미리 만들어두고 재활용 한다.
  * 모든 고객 요청은 동일한 서블릿 객체 인스턴스에 접근한다. (공유 변수 사용에 주의해야 함)
  * 서블릿 컨테이너 종료 시 서블릿 객체도 종료된다.
* JSP도 소블릿으로 변환되어서 사용한다.
* 동시 요청을 위한 멀티쓰레드 처리를 지원한다.
  * 동시에 많은 유저가 요청을 해도 서버가 요청을 잘 처리한다. 
  * 따라서 개발자는 멀티쓰레드에 대해서 크게 신경을 쓰지 않아도 WAS가 자동으로 해결해준다.)

