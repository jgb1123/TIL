# 메서드
## item49. 매개변수가 유효한지 검사하라
### 매개변수 검사는 가능한한 빠르게 진행해야 한다.
* 메서드와 생성자 대부분은 입력 매개변수와 값이 특정 조건을 만족하기를 바란다.
* 이런 제약은 반드시 문서화해야 하며, 메서드 몸체가 시작되기 전에 검사해야 한다.
* 오류는 가능한 한 빨리 발생한 곳에서 잡아야 한다.
* 오류를 발생한 즉시 잡지 못하면 해당 오류를 감지하기 어려워지고, 감지하더라도 오류의 발생 지점을 찾기 어려워진다.
* 메서드 몸체가 실행되기 전에 매개변수를 확인한다면 잘못된 값이 넘어왔을 때 즉각적이고 깔끔한 방식으로 예외를 던질 수 있다.
* 매개변수 검사를 제대로 하지 못하면 몇몇 문제가 생길 수 있다.
  * 메서드가 수행되는 중간에 모호한 예외를 던지며 실패할 수 있다.
  * 메서드가 잘 수행되지만 잘못된 결과를 반환한다.
  * 메서드는 문제없이 수행됐지만 어떤 객체를 이상한 상태로 만들어 놓아서 미래의 알 수 없는 시점에 이 메서드와는 관련없는 오류를 낼 수 있다.
* 즉 매개변수 검사에 실패하면 실패 원자성(failure atomicity)을 어기는 결과를 낳을 수 있다.

### public과 protected 메서드는 매개변수 값이 잘못 됐을 때 던지는 예외를 문서화해야 한다.
* `@throws` 자바독 태그를 사용하면 된다.
* 매개변수의 제약을 문서화한다면 그 제약을 어겼을 때 발생하는 예외도 함께 기술해야 한다.
* 이러한 간단한 방법으로 API 사용자가 제약을 지킬 가능성을 높일 수 있다.

### 메서드가 직접 사용하지는 않으나, 나중에 쓰기 위해 저장하는 매개변수는 더 신경써서 검사해야 한다.
* 예시로, 만약 null 검사를 생략했다면 이 매개변수를 나중에 쓰다가 NPE가 발생하면 해당 매개변수를 어디서 가져왔는지 추적하기가 어려워진다.
* 생성자 매개변수의 유효성 검사의 경우, 클래스 불변식을 어기는 객체가 만들어지지 않게 하는 데 꼭 필요하다.

### 메서드 매개변수 유효성 검사의 예외 케이스
* 유효성 검사 비용이 지나치게 높거나 실용적이지 않거나, 계산 과정에서 암묵적으로 검사가 수행되는 경우이다.
* 예를 들면 `Collections.sort(List)`처럼 객체 리스트를 정렬하는 메서드의 경우, 리스트 안의 객체들은 모두 상호 비교될 수 있어야 하며 정렬 과정에서 이 비교가 이뤄진다.
* 만약 상호 비교될 수 없는 타입의 객체가 들어있다면 그 객체를 비교할 때 `ClassCastException`을 던질 것이다.
* 즉 리스트 안의 모든 객체가 상호 비교될 수 있는지 검사해봐야 별로 얻는 이익이 없다.
* 그래도 이러한 암묵적 유효성 검사에 너무 의존하면 실패 원자성을 해칠 수 있으니 주의해야 한다.

### 매개변수 유효성 검사에 실패 후 잘못된 예외를 던지는 경우
* 계산 중 잘못된 매개변수 값을 사용해 발생한 예외와 API 문서에서 던지기로 한 예외가 다를 수 있다.
* 이러한 경우에는 예외번역(exception translate)를 사용하여 API 문서에 기재된 예외로 번역해줘야 한다. 

### 정리
* 메서드나 생성자를 작성할 때 그 매개변수들에 어떤 제약이 있을지 생각해야 한다.
* 그 제약들을 문서화하고 메서드 코드 시작 부분에서 명시적으로 검사하는 습관을 갖고 있어야 한다.