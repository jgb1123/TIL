# 람다와 스트림
## item42. 익명 클래스보다는 람다를 사용하라
### 익명클래스
* 예전에는 자바에서 함수 타입을 표현할 때 추상메서드를 하나만 담은 인터페이스(혹은 추상클래스)를 사용했다.
* 이런 인터페이스는 함수 객체라고 하며 특정 함수나 동작을 나타내는데 사용햇다.
* 1997년 JDK 1.1이 등장하면서 함수 객체를 만드는 주요 수단은 익명클래스가 되었었다.
* 함수 객체를 사용하는 과거 객체 지향 디자인 패턴에는 익명클래스면 충분했었다.
* 하지만 익명 클래스 방식은 코드가 너무 길기 때문에 자바는 함수형 프로그래밍에 적합하지 않았다.

### 람다식
* 자바 8에서 추상메서드 하나짜리 인터페이스는 특별한 대우를 받게 되었다.
* 함수형 인터페이스라 부르는 이 인터페이스들의 인스턴스를 람다식을 사용해 만들 수 있게 되었다.
* 람다는 함수나 익명 클래스와 개념은 비슷하지만 코드는 훨씬 간결하다.
```java
Collections.sort(words,
    (s1, s2) -> Integer.compare(s1.length(), s2.length()));
```
* 위 람다식에서 람다, 매개변수와 반환값의 타입은각각 `(Comparator<String>)`, `String`, `int` 이지만 코드에서는 표시되어있지 않다.
* 컴파일러가 문맥을 살펴 타입을 추론해주었기 때문이다.
* 상황에 따라 컴파일러가 타입을 결정하지 못할 수도 있는데, 그럴 때에는 직접 명시해야 한다.
* 따라서 타입을 명시해야 코드가 더 명확할 때만 제외하고는 람다의 모든 매개변수 타입은 생략해도 된다.

#### 위 예시를 더 간결하게 만든 예시 
```java
Collections.sort(words, comparingInt(String::length));
```
* 람다 자리에 비교자 생성 메서드를 사용하면 코드는 더 간결하게 만들 수 있다.

```java
words.sort(comparingInt(String::length));
```
* 자바 8에 List 인터페이스에 추가된 sort 메서드를 사용하면 더더욱 짧아진다.

### 람다식의 장점이 보이는 예시
```java
public enum Operation {
    PLUS("+") {
        public double apply(double x, double y) { return x + y; }
    },
    MINUS("-") {
        public double apply(double x, double y) { return x - y; }
    },
    ...
}
```
* 위와같이 열거 타입의 인스턴스 필드를 이용하여 상수별로 다르게 동작하는 코드를 만들 수 있다.
* 위 예시를 람다로 구현하면 훨씬 간결하고 깔끔해진다.

```java
public enum Operation {
    PLUS ("+", (x, y) -> x + y),
    MINUS ("-", (x, y) -> x - y),
    ...
}
```
### 람다 사용 시 주의할 점
* 람다는 이름이 없고 문서화도 하지 못한다.
* 따라소 코드 자체로 동작이 명확히 설명되지 않거나 코드 줄 수가 많아지면 람다를 쓰지 말아야 한다.
* 보통 람다는 1줄일 때가 가장 좋고, 길어야 3줄 안에 끝내는 것이 좋다.
* 그 이상 넘어가면 가독성이 심하게 나빠지며, 만약 람다가 길거나 읽기 어렵다면 람다를 쓰지 않는 쪽으로 리팩토링 하는것이 좋다.
* 람다도 익명 클래스처럼 직렬화 형태가 구현별로 다를 수 있기 때문에 람다를 직렬화하는 일은 극히 조심해야 한다.
  * 익명클래스의 인스턴스도 마찬가지이다.

### 람다 vs 익명클래스
* 람다로 대체할 수 없는 곳이 있다.
* 람다는 함수형 인터페이스에서만 쓰인다.
  * 추상 클래스의 인스턴스를 만들 때 람다를 쓸 수 없으며, 익명 클래스를 써야 한다.
  * 비슷하게 추상 메서드가 여러 개인 인터페이스의 인스턴스를 만들 때도 익명클래스를 쓸 수 있다.
* 또한 람다는 자신을 참조할 수 없다.
  * 람다에서의 this는 바깥 인스턴스를 가리키지만, 익명 클래스에서의 this는 익명클래스의 인스턴스 자신을 가리킨다.

### 정리
* 자바 8에서 작은 함수 객체를 구현하는 데 적합한 람다가 도입되었다.
* 익명 클래스는 함수형 인터페이스가 아닌 타입의 인스턴스를 만들 때만 사용하면 된다.
* 람다는 작은 함수 객체를 아주 쉽게 표현할 수 있기 때문에 자바에서는 쉽지 않던 함수형 프로그래밍의 문을 열었다. 